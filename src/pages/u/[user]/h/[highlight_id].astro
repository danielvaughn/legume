---
import UserHeader from "../../../../components/UserHeader.astro";
import Layout from "../../../../layouts/Layout.astro";
import Prose from "../../../../components/Prose.astro";

const { highlight_id } = Astro.params;
const highlights = await Astro.glob("../../../../content/highlights/*.md");

const highlight = highlights.find((j) => j.frontmatter.id === highlight_id);

if (!highlight) {
  return Astro.redirect("/four-oh-four");
}

const { Content } = highlight;
---

<Layout title={highlight.frontmatter.title}>
  <UserHeader />
  <main class="max-w-2xl mx-auto px-5 pb-12 md:px-0">
    <section class="mt-8">
      <header>
        <h2
          class="font-bold uppercase tracking-wide border-black border-b-2 pb-1"
        >
          Achievement
        </h2>

        <h3 class="font-bold mt-4">{highlight.frontmatter.title}</h3>

        <span class="block italic">
          as {highlight.frontmatter.job_title} at {
            highlight.frontmatter.company
          }
        </span>
      </header>
    </section>

    <section class="mt-6 md-content">
      <Content />
    </section>

    <footer class="mt-8 mb-12">
      <h3
        class="uppercase font-bold tracking-wide border-black border-b-2 pb-1"
      >
        All achievements as {highlight.frontmatter.job_title} at {
          highlight.frontmatter.company
        }
      </h3>
      <ul class="list-disc pl-6 mt-5">
        {
          highlights.map((j) => {
            if (j.frontmatter.id === highlight.frontmatter.id) {
              return (
                <li class="text-neutral-500 select-none">
                  {j.frontmatter.title}
                </li>
              );
            }

            return (
              <li>
                <a
                  href={`/u/danielvaughn/h/${j.frontmatter.id}`}
                  class="hover:text-blue-700 hover:underline cursor-pointer"
                >
                  {j.frontmatter.title}
                </a>
              </li>
            );
          })
        }
      </ul>
      <div class="mt-5">
        <a
          href={`/u/danielvaughn/j/${highlight.frontmatter.job_id}`}
          class="text-blue-700 underline dark:text-blue-500"
        >
          Read more about my experiences as {highlight.frontmatter.job_title} at
          {highlight.frontmatter.company}
        </a>
      </div>
    </footer>
  </main>
</Layout>

<style is:global>
  .md-content p {
    @apply mb-2 leading-snug text-pretty;
  }

  .md-content a {
    @apply text-blue-700 hover:underline dark:text-blue-500;
  }

  .md-content p > code {
    @apply text-xs text-emerald-200 bg-emerald-900 px-1 py-px;
  }

  .md-content pre.astro-code {
    @apply p-3 my-3 leading-normal;
    font-size: 12px;
  }
</style>
